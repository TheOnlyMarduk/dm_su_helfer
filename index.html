<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8" />
<title>Leaflet Helferkarte</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>

<style>
  html, body { margin: 0; padding: 0; height: 100%; }
  #map { height: 100vh; width: 100vw; }
  .marker-label {
    background: white;
    border: 1px solid black;
    border-radius: 3px;
    padding: 2px 4px;
    font-size: 12px;
    font-weight: bold;
    white-space: nowrap;
  }
</style>
</head>
<body>
<div id="map"></div>

<script>
// ===================== Karte initialisieren =====================
const map = L.map('map').setView([50.94, 6.95], 13);

// Basiskarte
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: '© OpenStreetMap'
}).addTo(map);

// ===================== Helfer-Layer erstellen =====================
const helferLayer = L.layerGroup();

// GeoJSON laden
fetch('helfer.geojson')
  .then(res => res.json())
  .then(data => {
    L.geoJSON(data, {
      pointToLayer: (feature, latlng) => {
        // Beschriftung mit ID
        const labelIcon = L.divIcon({
          className: 'marker-label',
          html: feature.properties.id || '',
          iconAnchor: [15, -5] // <<--- Hier Position der Beschriftung ändern
        });

        const marker = L.marker(latlng, { icon: labelIcon });

        // Tooltip zusammensetzen
        const tooltipContent =
          `Anzahl: ${feature.properties.Anzahl || ''}<br>` +
          `Ausrüstung: ${feature.properties.Ausrüstung || ''}<br>` +
          `Aufgabe: ${feature.properties.Aufgabe || ''}<br>` +
          `Erfahrung: ${feature.properties.Erfahrung || ''}`;

        marker.bindTooltip(tooltipContent, {
          permanent: false,
          direction: 'top',
          sticky: true
        });

        return marker;
      }
    }).addTo(helferLayer);
  })
  .catch(err => console.error('Fehler beim Laden von helfer.geojson:', err));

// ===================== Layer Control =====================
const overlays = {
  "Helfer": helferLayer
};

// Helfer-Layer direkt beim Start aktivieren
helferLayer.addTo(map);

// Layer-Kontrolle mit ausgeklappter Legende
L.control.layers({}, overlays, { collapsed: false }).addTo(map);

</script>
</body>
</html>
